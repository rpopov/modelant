<?xml version="1.0" encoding="UTF-8"?>
<!--
 * Copyright (c) 2001,2012 Rusi Popov, MDA Tools.net
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors:
 *    Rusi Popov (popovr@mdatools.net) - initial implementation
 -->

<!--
   An example of copying a UML 1.3 model as a UML 1.4 model. Note the use of<ul>
   <li> uml13.* and uml14.* macros
   <li> <b>uml13.copy.uml14</b> macro which specializes the general task of copying models between different metamodels
        with established correspondence between the metamodel elemenets. Actually, this macro uses the results of
        the comparison of UML 1.3 and UML 1.4 metamodels.
   </ul>
   This is a demonstration of <b>uml13.copy.uml14</b> macro.
  -->
<project name="build-products" basedir="../..">
  <import file="..\..\..\..\env.xml"/>

  <!--
    Assumption: the needed libraries are already listed in classpath / classloader
    -->
  <typedef resource="net/mdatools/modelant/uml13/reverse/antlib.xml"/>
  <typedef resource="uml13/meta.xml"/>
  <typedef resource="uml14/meta.xml"/>

  <property name="modelFileToImport"    value="${xmi}/vegas_model-head.xml" />

  <echo>
    Copy UML 1.3 model as UML 1.4 model
  </echo>

  <mdr work="${work}"/>
  <uml13.load.metamodel/>
  <uml13.instantiate extent="SOURCE"/>

  <!-- Import a vegas model in the model repository -->
  <mdr.read.xmi extent="SOURCE"
                file="${modelFileToImport}" />

  <!-- Instantiarte a (MOF) reporsitpry for the meta-model -->
  <uml14.load.metamodel/>
  <uml14.instantiate extent="TARGET"/>

  <uml13.copy.uml14 uml13.extent="SOURCE" uml14.extent="TARGET"/>

  <echo> Exporting result... </echo>
  <mdr.write.xmi extent="TARGET"
            file="${out}/copy-to-14.xml"
            xmiVersion="1.2"/>
</project>